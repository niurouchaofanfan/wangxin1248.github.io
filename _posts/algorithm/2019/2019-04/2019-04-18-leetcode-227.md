---
layout: post
title:  "LeetCode 227. 基本计算器 II"
date:  2019-04-18
desc: "LeetCode 题目之 227. 基本计算器 II"
keywords: "LeetCode,刷题算法,C++,227. 基本计算器 II"
categories: [Algorithm]
tags: [LeetCode,算法,C++]
---
# 基本计算器 II

## 题目描述

实现一个基本的计算器来计算一个简单的字符串表达式的值。

字符串表达式仅包含非负整数，+， - ，*，/ 四种运算符和空格  。 整数除法仅保留整数部分。

示例 1:

```
输入: "3+2*2"
输出: 7
```

示例 2:

```
输入: " 3/2 "
输出: 1
```

示例 3:

```
输入: " 3+5 / 2 "
输出: 5
```

说明：

- 你可以假设所给定的表达式都是有效的。
- 请不要使用内置的库函数 eval。

## 解题思路

这道题是之前那道 Basic Calculator 的拓展，不同之处在于那道题的计算符号只有加和减，而这题加上了乘除，那么就牵扯到了运算优先级的问题，好在这道题去掉了括号，还适当的降低了难度，估计再出一道的话就该加上括号了。不管那么多，这道题先按木有有括号来处理。

由于存在运算优先级，我们采取的措施是使用一个栈保存数字，如果该数字之前的符号是加或减，那么把当前数字压入栈中，注意如果是减号，则加入当前数字的相反数，因为减法相当于加上一个相反数。如果之前的符号是乘或除，那么从栈顶取出一个数字和当前数字进行乘或除的运算，再把结果压入栈中，那么完成一遍遍历后，所有的乘或除都运算完了，再把栈中所有的数字都加起来就是最终结果了。

## 代码

```cpp
class Solution {
public:
    int calculate(string s) {
        // 有个测试用例 int 型会超范围
        long n = s.size(), num = 0, result = 0;
        // 假设第一个运算符为+，即第一个数直接入栈
        char op = '+';
        stack<int> nums;
        
        for(int i=0;i<n;++i){
            // 是数字
            if(s[i]>='0'){
                num = num*10+s[i]-'0';
            }
            // 是运算符或最后一个数字
            if((s[i]<'0'&&s[i]!=' ') || i==n-1){
                if(op == '+') nums.push(num);
                if(op == '-') nums.push(-num);
                if(op == '*' || op == '/'){
                    int temp = (op == '*') ? nums.top()*num : nums.top()/num;
                    nums.pop();
                    nums.push(temp);
                }
                op = s[i];
                num = 0;
            }
        }
        
        // 计算结果
        while(!nums.empty()){
            result += nums.top();
            nums.pop();
        }
        return result;
    }
};
```

## tips

- c++判断一个字符是否是数字，只需要判断该字符是否 > '0' 字符即可。
- c++中把字符串转变为 int 类型操作：字符串-'0' 即可。